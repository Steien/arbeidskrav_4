<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Trond Steien">

<title>Oppgave 4: Study designs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="arbeidskrav_4_Trond_files/libs/clipboard/clipboard.min.js"></script>
<script src="arbeidskrav_4_Trond_files/libs/quarto-html/quarto.js"></script>
<script src="arbeidskrav_4_Trond_files/libs/quarto-html/popper.min.js"></script>
<script src="arbeidskrav_4_Trond_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="arbeidskrav_4_Trond_files/libs/quarto-html/anchor.min.js"></script>
<link href="arbeidskrav_4_Trond_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="arbeidskrav_4_Trond_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="arbeidskrav_4_Trond_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="arbeidskrav_4_Trond_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="arbeidskrav_4_Trond_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Oppgave 4: Study designs</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Trond Steien </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Inkluder det brede spørsmålet (Q fra QALMRI) Presenter de spesifikke spørsmålene for hver studie (Q fra QALMRI) Gi en kort oversikt over temaet og dets betydning</p>
<section id="introduksjon" class="level1">
<h1>Introduksjon</h1>
<p>Dette er oppgave 4: “Study designs” i faget IDR4000-1 24H Kvantitativ metode og statistikk. Vi skal velge oss ut 5 forskningartikler og analysere de ved bruk av QALMRI metoden. Fokus skal være studie design og statistiske modeller eller tester brukt. Avslutningsvis gir jeg en anbefaling om hvordan studier innenfor dette feltet burde settes opp for å svare på lignende spørsmål.</p>
<p>Jeg har valgt å se på “Sammenhengen mellom fysisk aktivitetsnivå og dødelighet fra alle årsaker i befolkningen”</p>
<p>Fysisk aktivitet(FA) er kjent for å ha en rekke helsefordeler, inkludert forbedret kardiovaskulær helse, bedre mental velvære og redusert risiko for kroniske sykdommer<span class="citation" data-cites="stensel">(<a href="#ref-stensel" role="doc-biblioref">Stensel et al., 2021</a>)</span>. En viktig dimensjon av denne forskningen er hvordan fysisk aktivitetsnivå påvirker dødelighet fra alle årsaker, også kjent som total dødelighet. Dette gir innsikt i hvordan livsstilsintervensjoner kan forbedre folkehelsen<span class="citation" data-cites="stensel">(<a href="#ref-stensel" role="doc-biblioref">Stensel et al., 2021</a>)</span>. Min interesse i dette temaet er drevet av et ønske om å forstå de nyeste funnene innen dette forskningsfeltet og hvordan de kan styrke vår kunnskap om korrelasjonen mellom fysisk aktivitet og dødelighet.Ved å fokusere på total dødelighet, søker jeg å forstå hvordan fysisk aktivitet påvirker generell dødelighet, uavhengig av spesifikke sykdommer som hjerneinfarkt eller diabetes.</p>
<p>For å identifisere relevante studier, utførte jeg et søk i Medline-databasen med søkestrengen “TI (physical activity or exercise) AND TI all-cause mortality AND TI Population”. Jeg valgte å søke i titler for å begrense antall resultater og fokuserte på fagfellevurderte artikler publisert mellom 2019 og 2024. Søkedatoen var 22. oktober 2024, og jeg begrenset språket til engelsk. Dette resulterte i ni treff, hvorav jeg valgte de fem mest relevante basert på egen vurdering.</p>
<p>De fem utvalgte studiene er som følger:</p>
<p><span class="citation" data-cites="liang2023">Liang et al. (<a href="#ref-liang2023" role="doc-biblioref">2023</a>)</span> “Joint association of physical activity and sleep duration with risk of all-cause and cause-specific mortality: a population-based cohort study using accelerometry.”</p>
<p><span class="citation" data-cites="cho2023">Cho et al. (<a href="#ref-cho2023" role="doc-biblioref">2023</a>)</span> “Aerobic, muscle-strengthening, and flexibility physical activity and risks of all-cause and cause-specific mortality: a population-based prospective cohort of Korean adults”</p>
<p><span class="citation" data-cites="lee2023">Lee et al. (<a href="#ref-lee2023" role="doc-biblioref">2023</a>)</span> “Associations of Long-Term Physical Activity Trajectories With All-Cause Mortality in a General Population”</p>
<p><span class="citation" data-cites="holtermann2021">Holtermann (<a href="#ref-holtermann2021" role="doc-biblioref">2021</a>)</span> “The physical activity paradox in cardiovascular disease and all-cause mortality: the contemporary Copenhagen General Population Study with 104 046 adults”</p>
<p><span class="citation" data-cites="li2022">Li (<a href="#ref-li2022" role="doc-biblioref">2022</a>)</span> “Long-term physical activity participation trajectories were associated with subsequent cognitive decline, risk of dementia and all-cause mortality among adults aged ≥50 years: a population-based cohort study”</p>
</section>
<section id="studie-design" class="level1">
<h1>Studie design</h1>
<p>Felles for alle studiene er at de har brukt prospektive kohort-studiedesign. Dette er en observasjonsstudie-design som måler egenskaper hos hver deltaker som kan forutsi fremtidige utfall, og følger deltakerne med målinger av de relevante utfallene <span class="citation" data-cites="hulley">(<a href="#ref-hulley" role="doc-biblioref">Hulley et al., 2013</a>)</span>. I dette tilfellet er det primære utfallet dødelighet, mens fysisk aktivitet (FA) er den hovedprediktoren som studeres. En stor fordel med denne type design er at det tillater kalkulering av insidens - antallet nye tilfeller av en tilstand som oppstår over tid <span class="citation" data-cites="hulley">(<a href="#ref-hulley" role="doc-biblioref">Hulley et al., 2013</a>)</span>.</p>
<p>Å måle nivåene av prediktoren (FA) før utfallet (død) skjer, etablerer tidsrekkefølgen for variablene, noe som styrker prosessen med å trekke konklusjoner om årsakssammenhenger. I tillegg vil det prospektive designet forhindre at prediktorene blir påvirket av utfallet, og variablene kan måles mer komplett<span class="citation" data-cites="hulley">(<a href="#ref-hulley" role="doc-biblioref">Hulley et al., 2013</a>)</span>. Blant studiene vi analyserer, er <span class="citation" data-cites="liang2023">Liang et al. (<a href="#ref-liang2023" role="doc-biblioref">2023</a>)</span> den eneste som målte FA objektivt med akselerometer over 7 dager, noe som gir mer presise data enn selvrapportering, men er mere kostbart<span class="citation" data-cites="hulley">(<a href="#ref-hulley" role="doc-biblioref">Hulley et al., 2013</a>)</span>. De andre studiene <span class="citation" data-cites="cho2023 lee2023 holtermann2021 li2022">(<a href="#ref-cho2023" role="doc-biblioref">Cho et al., 2023</a>; <a href="#ref-holtermann2021" role="doc-biblioref">Holtermann, 2021</a>; <a href="#ref-lee2023" role="doc-biblioref">Lee et al., 2023</a>; <a href="#ref-li2022" role="doc-biblioref">Li, 2022</a>)</span> baserte seg på selvrapportert FA. I motsetning vil et retrospektivt kohortestudie som ser på dødlighet, måtte de ha rekonstruere informasjon om de avdøde fra indirekte kilder som medisinske journaler eller slektninger <span class="citation" data-cites="hulley">(<a href="#ref-hulley" role="doc-biblioref">Hulley et al., 2013</a>)</span>. Dette gjelder både for FA-data, og for all informasjon om den avdøde, noe som kan påvirke nøyaktigheten av dataene.</p>
<p>Dette studiedesignet har samme svakheter som alle andre observasjonsstudier. Det er utfordrende å trekke slutninger om årsakssammenhenger, og tolkningen blir ofte uklar på grunn av påvirkningen fra konfunderende variabler <span class="citation" data-cites="hulley">(<a href="#ref-hulley" role="doc-biblioref">Hulley et al., 2013</a>)</span>. For studier som ser på FA og dødelighet, kan faktorer som kosthold, sosioøkonomisk status, og generell helsetilstand være viktige konfunderende variabler<span class="citation" data-cites="stensel">(<a href="#ref-stensel" role="doc-biblioref">Stensel et al., 2021</a>)</span>. En svakhet ved prospektive design er at de kan være kostbare og ineffektive for å studere sjeldne utfall <span class="citation" data-cites="hulley">(<a href="#ref-hulley" role="doc-biblioref">Hulley et al., 2013</a>)</span>. I konteksten av disse studiene er dødelighet ikke et sjeldent utfall, men snarere et vanlig endepunkt som observeres over tid i store befolkningsgrupper. Dette gjør prospektive kohortstudier godt egnet for å undersøke sammenhengen mellom FA og dødelighet.</p>
<p>Oppfølgingstiden varierer også betydelig mellom studiene, fra 6 år <span class="citation" data-cites="li2022">(<a href="#ref-li2022" role="doc-biblioref">Li, 2022</a>)</span> til 16,8 år <span class="citation" data-cites="lee2023">(<a href="#ref-lee2023" role="doc-biblioref">Lee et al., 2023</a>)</span>, noe som kan påvirke styrken av de observerte sammenhengene mellom FA og dødelighet<span class="citation" data-cites="hulley">(<a href="#ref-hulley" role="doc-biblioref">Hulley et al., 2013</a>)</span>. Utvalgsstørrelsen varierte også betydelig mellom studiene, fra <span class="citation" data-cites="li2022">Li (<a href="#ref-li2022" role="doc-biblioref">2022</a>)</span> med 8,842 deltakere over 50 år i England, til <span class="citation" data-cites="holtermann2021">Holtermann (<a href="#ref-holtermann2021" role="doc-biblioref">2021</a>)</span> som inkluderte hele 104,046 voksne i alderen 20-100 år fra den generelle befolkningen i København.</p>
<p>Studiene representerer en bred geografisk spredning, fra <span class="citation" data-cites="liang2023">Liang et al. (<a href="#ref-liang2023" role="doc-biblioref">2023</a>)</span> som brukte data fra en stor britisk biobank, <span class="citation" data-cites="cho2023">Cho et al. (<a href="#ref-cho2023" role="doc-biblioref">2023</a>)</span> som fokuserte på en koreansk voksenpopulasjon, <span class="citation" data-cites="lee2023">Lee et al. (<a href="#ref-lee2023" role="doc-biblioref">2023</a>)</span> som studerte en taiwansk befolkning, <span class="citation" data-cites="holtermann2021">Holtermann (<a href="#ref-holtermann2021" role="doc-biblioref">2021</a>)</span> som undersøkte innbyggere i København, til <span class="citation" data-cites="li2022">Li (<a href="#ref-li2022" role="doc-biblioref">2022</a>)</span> som analyserte data fra eldre voksne i England. Denne geografiske variasjonen kan påvirke resultatene gjennom forskjeller i livsstil, kosthold, helsetjenester, og kulturelle holdninger til fysisk aktivitet mellom landene. For eksempel kan den urbane befolkningen i København ha andre muligheter for fysisk aktivitet enn den mer varierte populasjonen i den britiske biobankstudien. Videre kan kulturelle forskjeller i arbeids- og fritidsaktiviteter mellom asiatiske og europeiske land påvirke hvordan fysisk aktivitet relaterer seg til helseutfall.</p>
<p>Hver studie fokuserer på spesifikke aspekter ved sammenhengen mellom fysisk aktivitet og dødelighet:</p>
<p><span class="citation" data-cites="liang2023">Liang et al. (<a href="#ref-liang2023" role="doc-biblioref">2023</a>)</span>: Undersøker sammenhengen mellom akselerometer-målt fysisk aktivitet og søvnvarighet med risiko for dødelighet fra alle årsaker og kardiovaskulære årsaker. Studien inkluderte 92,221 deltakere (gjennomsnittlig alder 62.4 år) og hadde en median oppfølgingstid på 7,0 år.</p>
<p><span class="citation" data-cites="cho2023">Cho et al. (<a href="#ref-cho2023" role="doc-biblioref">2023</a>)</span>: Fokuserer på effekten av aerob og muskelstyrkende fysisk aktivitet, både separat og kombinert, samt fleksibilitetsøvelser, på risikoen for dødelighet fra alle årsaker. Studien omfattet 34,379 koreanske voksne i alderen 20-79 år.</p>
<p><span class="citation" data-cites="lee2023">Lee et al. (<a href="#ref-lee2023" role="doc-biblioref">2023</a>)</span>: Analyserer langvarige mønstre av fysisk aktivitet og deres sammenheng med dødelighet fra alle årsaker. Studien inkluderte 21,211 deltakere i alderen 18-90 år, med en median oppfølgingstid på 16.8 år.</p>
<p><span class="citation" data-cites="holtermann2021">Holtermann (<a href="#ref-holtermann2021" role="doc-biblioref">2021</a>)</span>: Utforsker det fysiske aktivitetsparadokset ved å sammenligne effekten av arbeidsrelatert og fritidsrelatert fysisk aktivitet på kardiovaskulær sykdom og allmenn dødelighet. Studien omfattet 104,046 deltakere i alderen 20-100 år, med 10 års oppfølging.</p>
<p><span class="citation" data-cites="li2022">Li (<a href="#ref-li2022" role="doc-biblioref">2022</a>)</span>: Undersøker hvordan langvarig deltakelse i fysisk aktivitet påvirker kognitiv nedgang, risiko for demens, og allmenn dødelighet hos voksne over 50 år. Studien inkluderte 8,842 deltakere og hadde en oppfølgingstid på 6 år.</p>
<pre><code>Gi en generell innføring i ulike studiedesign, inkludert hvordan de valgte studiene forholder seg til andre design
Sammenlign designene brukt i de analyserte studiene
Diskuter styrker og svakheter ved de valgte designene (M fra QALMRI)</code></pre>
</section>
<section id="statistiske-modeller" class="level1">
<h1>Statistiske modeller</h1>
<pre><code>Beskriv de statistiske metodene som brukes i studiene
Forklar metodene med henvisning til pensum eller annen relevant litteratur
Diskuter hvorfor disse metodene er passende for forskningsspørsmålene
Hvis mulig, nevn hvilke R-kommandoer som kunne blitt brukt for å gjenskape analysene</code></pre>
</section>
<section id="diskusjon" class="level1">
<h1>Diskusjon:</h1>
<pre><code>Oppsummer hovedresultatene fra studiene (R fra QALMRI)
Diskuter logikken bak hypotesene og alternative forklaringer (L og A fra QALMRI)
Vurder styrker og svakheter ved studiedesignene og de statistiske metodene
Kom med egne meninger om studiedesignene og analysene, og foreslå eventuelle forbedringer</code></pre>
<p>Konklusjon:</p>
<pre><code>Oppsummer hovedfunnene
Diskuter slutninger basert på resultatene (I fra QALMRI)
Gi anbefalinger for fremtidig forskning</code></pre>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-cho2023" class="csl-entry" role="listitem">
Cho, Y., Jang, H., Kwon, S., &amp; Oh, H. (2023). Aerobic, muscle-strengthening, and flexibility physical activity and risks of all-cause and cause-specific mortality: A population-based prospective cohort of korean adults. <em>BMC Public Health</em>, <em>23</em>, 1148. <a href="https://doi.org/10.1186/s12889-023-15969-1">https://doi.org/10.1186/s12889-023-15969-1</a>
</div>
<div id="ref-holtermann2021" class="csl-entry" role="listitem">
Holtermann, P. N., Andreas; Schnohr. (2021). The physical activity paradox in cardiovascular disease and all-cause mortality: The contemporary copenhagen general population study with 104046 adults. <em>European Heart Journal</em>, <em>42</em>(15), 1499–1511. <a href="https://doi.org/10.1093/eurheartj/ehab087">https://doi.org/10.1093/eurheartj/ehab087</a>
</div>
<div id="ref-hulley" class="csl-entry" role="listitem">
Hulley, S. B., Cummings, S. R., Browner, W. S., Grady, D. G., &amp; Newman, T. B. (2013). <em>Designing clinical research</em> (4th ed.). Lippincott Williams; Wilkins.
</div>
<div id="ref-lee2023" class="csl-entry" role="listitem">
Lee, C.-L., Liu, W.-J., Chen, C.-H., &amp; Wang, J.-S. (2023). Associations of long-term physical activity trajectories with all-cause mortality in a general population. <em>International Journal of Public Health</em>, <em>68</em>. <a href="https://doi.org/10.3389/ijph.2023.1605332">https://doi.org/10.3389/ijph.2023.1605332</a>
</div>
<div id="ref-li2022" class="csl-entry" role="listitem">
Li, Y. H., Chenglong; Ma. (2022). Long-term physical activity participation trajectories were associated with subsequent cognitive decline, risk of dementia and all-cause mortality among adults aged ≥50 years: A population-based cohort study. <em>Age and Ageing</em>, <em>51</em>. <a href="https://doi.org/10.1093/ageing/afac071">https://doi.org/10.1093/ageing/afac071</a>
</div>
<div id="ref-liang2023" class="csl-entry" role="listitem">
Liang, Y. Y., Feng, H., Chen, Y., Jin, X., Xue, H., Zhou, M., Ma, H., Ai, S., Wing, Y.-K., Geng, Q., &amp; Zhang, J. (2023). Joint association of physical activity and sleep duration with risk of all-cause and cause-specific mortality: A population-based cohort study using accelerometry. <em>European Journal of Preventive Cardiology</em>, <em>30</em>(9), 832–843. <a href="https://doi.org/10.1093/eurjpc/zwad060">https://doi.org/10.1093/eurjpc/zwad060</a>
</div>
<div id="ref-stensel" class="csl-entry" role="listitem">
Stensel, D. J., Hardman, A. E., &amp; Gill, J. M. R. (2021). <em>Physical activity and health: The evidence explained</em>. Routledge.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>